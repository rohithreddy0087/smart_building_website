CREATE TABLE USERS(
   ID SERIAL PRIMARY KEY     NOT NULL,
   FIRSTNAME           TEXT    NOT NULL,
   LASTNAME           TEXT    ,
   EMAIL            TEXT     NOT NULL UNIQUE,
   AFFILIATION      TEXT NOT NULL,
   AFFILIATION_TYPE      TEXT NOT NULL,
   JOB      TEXT NOT NULL,
   REGISTERATION_TIMESTAMP TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE CREDENTIALS(
   ID SERIAL PRIMARY KEY     NOT NULL,
   EMAIL            TEXT     references USERS(EMAIL),
   PASSWORD            TEXT     NOT NULL
);

; DB_HOST = mesl-exp.ucsd.edu
; DB_PORT = 35432
; DB_NAME = brick
; DB_USER = exp
; DB_PASS = mesl2022
; DB_TABLE = brick_data


create function f_round5min
(
@date datetime
) returns datetime
as
begin -- adding 150 seconds to round off instead of truncating
return dateadd(minute, datediff(minute, '1900-01-01', dateadd(second, 150, @date))/5*5, 0)
end


SELECT 
    date_trunc('hour', ht.time) 
    + date_part('minute', ht.time)::int / 5 * interval '5 min'
FROM huge_table AS ht LIMIT 4000000

SELECT date_trunc('hour', ht.time) + date_part('minute', ht.time)::int / 5 * interval '5 min' FROM nae_01_room_104_actual_cooling_setpt as ht limit 10;